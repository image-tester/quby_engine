=marukufix(question.title, "answer_#{question.key}")
.description-and-fields
  .description
    - unless question.description.blank?
      :markdown
        #{raw question.description}
  .fields(id="answer_#{question.key}_input")
    %select(name="answer[#{question.key}]") 
      -question.options.each do |opt|
        - checked = @answer.send(question.key) == opt.key.to_s
        - next if (opt.hidden and not checked)
        - @answer.to_hide += opt.hides_questions if checked
        - cls = [question.type]
        - cls << "subinput"  if subquestion
        - hash = {:value => opt.key, :hides => opt.hides_questions.to_json || "[]", :allhidden => question.hides_questions.to_json ||"[]", :class => cls, :disabled => disabled ? "" : nil}
        - hash[:selected] = 'selected' if @answer.send(question.key) == opt.key.to_s 
        %option{hash}
          =opt.description
