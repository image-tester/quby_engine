- show_values = question.show_values == true or question.show_values == :all or question.show_values == session[:display_mode].to_sym
- if not question.disallow_bulk and question.subquestions.blank?
  %label.main(for="answer_#{question.key}")= raw(question.title)
  .description-and-fields
    .fields(id="answer_#{question.key}_input" class="options#{question.options.size}}")
      - question.options.each_with_index do |opt, idx|
        -next if opt.inner_title
        - cls = []
        - cls << "first" if idx <= 0
        - cls << "last" if idx >= (question.options.size - 1)
        - cls << "optionwidth#{question.options.size}"
        .option{:class => cls}
          - radio_classes = []
          - radio_classes << "subinput" if subquestion
          - radio_classes << "deselectable" if question.deselectable          
          = radio_button(:answer, question.key, opt.key, {:hides => opt.hides_questions.to_json || "[]", :allhidden => question.hides_questions.to_json ||"[]", :class => radio_classes})
          -if show_values
            %span.value= opt.value
- else
  - content_for(:item_class, "notbulk")
  %label.main(for="answer_#{question.key}")= raw(question.title)
  .description-and-fields
    .description
      - unless question.description.blank?
        :markdown
          #{raw question.description}
    .fields(id="answer_#{question.key}_input")
      - question.options.each do |opt|
        - if opt.inner_title
          .inner-title
            :markdown
              #{raw opt.description}
        - else
          .option(class="#{show_values ? 'show_values' : nil}")
            .radiocheckwrapper
              = radio_button(:answer, question.key, opt.key, {:hides => opt.hides_questions.to_json || "[]", :allhidden => question.hides_questions.to_json ||"[]", :class => subquestion ? "subinput" : ""})
            - if show_values
              .value= opt.value
            .labelwrapper
              %label(for="answer_#{question.key}_#{opt.key}")
                %span
                  :markdown
                    #{raw opt.description}
            - unless opt.questions.empty?
              .subquestions= render :partial => "answers/paged/item", :collection => opt.questions,  :locals => {:subquestion => true}
      = radio_button_tag(question.key, "DESELECTED_RADIO_VALUE", false, :class => "hidden")